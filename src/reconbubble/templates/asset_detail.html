{% extends "base.html" %}
{% block content %}
<h1>Asset: {{ host.ip }}</h1>
{% if in_scope %}<div class="pill inscope">IN SCOPE</div>{% else %}<div class="pill outscope">OUT OF SCOPE</div>{% endif %}

<div class="split">
  <div class="card">
    <h2>Details</h2>
    <div><b>Hostname:</b> {{ host.hostname }}</div>
    <div><b>OS Guess:</b> {{ host.os_guess }}</div>
  </div>
  <div class="card">
    <h2>Add note</h2>
    <form action="/notes/add" method="post">
      <input type="hidden" name="object_type" value="host"/>
      <input type="hidden" name="object_id" value="{{ host.id }}"/>
      <input type="hidden" name="redirect" value="/asset/{{ host.id }}"/>
      <label>Severity</label>
      <select name="severity"><option>info</option><option>low</option><option>med</option><option>high</option></select>
      <label>Tags</label><input name="tags" placeholder="vpn, external, priority"/>
      <label>Note</label><textarea name="body" rows="6" required></textarea>
      <button class="btn" type="submit">Save note</button>
    </form>
  </div>
</div>

<h2>Services</h2>
<table>
  <thead><tr><th>Port</th><th>Proto</th><th>State</th><th>Service</th><th>Product</th><th>Version</th></tr></thead>
  <tbody>
    {% for s in services %}
      <tr>
        <td><a href="/service/{{ s.id }}">{{ s.port }}</a></td>
        <td>{{ s.proto }}</td>
        <td>{{ s.state }}</td>
        <td>{{ s.service_name }}</td>
        <td>{{ s.product }}</td>
        <td>{{ s.version }}</td>
      </tr>
    {% endfor %}
  </tbody>
</table>

<h2>Notes</h2>
{% if notes %}
  {% for n in notes %}
    <div class="card">
      <div class="muted">{{ n.created_at }} · {{ n.severity }} · {{ n.tags }}</div>
      <pre class="note">{{ n.body }}</pre>
    </div>
  {% endfor %}
{% else %}
  <p class="muted">No notes yet.</p>
{% endif %}
{% endblock %}
